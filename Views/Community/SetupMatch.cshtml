@{
    ViewData["Title"] = "Setup Match Format";
}

     <!-- Match Format -->
        <h5 class="mt-3">Setup Match Format</h5>
        <form> 
        <select class="form-select mb-3" id="matchFormat" onchange="toggleMatchOptions()">
            <option>Pool Play</option>
            <option>Elimination</option>
            <option>Round Robin</option>
        </select>

        <!-- Pool Play Options -->
        <div id="poolOptions">
            <label>Number of Pools</label>
            <input type="number" class="form-control mb-2"/>
            <label>Winners per Pool</label>
            <input type="number" class="form-control mb-2"/>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="doublePool">
                <label class="form-check-label">Double Pool (each team plays others twice)</label>
            </div>
            <label class="mt-2">Standing Calculation</label>
            <select class="form-select mb-2">
                <option>Win-Loss Point</option>
                <option>Win %</option>
                <option>Games Win %</option>
                <option>Games Won</option>
                <option>Total Scores</option>
            </select>
            <h6>Point System</h6>
            <input type="number" class="form-control mb-2" placeholder="Standard Win (default 3)"/>
            <input type="number" class="form-control mb-2" placeholder="Standard Loss (default 0)"/>
            <input type="number" class="form-control mb-2" placeholder="Tiebreaker Win (default 3)"/>
            <input type="number" class="form-control mb-2" placeholder="Tiebreaker Loss (default 1)"/>
            <input type="number" class="form-control mb-2" placeholder="Draw (default 1)"/>
        </div>

        <!-- Elimination Options -->
        <div id="elimOptions" style="display:none;">
            <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" checked> <label>3rd Place Match</label>
            </div>
            <textarea class="form-control" placeholder="Match Rule"></textarea>
        </div>

        <!-- Round Robin Options -->
        <div id="rrOptions" style="display:none;">
            <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input"> <label>Double Round</label>
            </div>
            <textarea class="form-control" placeholder="Match Rule"></textarea>
        </div>
      <div class="d-flex justify-content-between mt-3">
            <a href="@Url.Action("Index","Community")" class="btn btn-outline-secondary">Back</a>
            <button type="button" class="btn btn-success" onclick="reviewSetup()">Review Setup</button>
        </div>
    </div>
</form>
</div>

<!-- Review Modal -->
<div class="modal fade" id="reviewModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Review Match Setup</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p id="reviewSummary">Loading summary...</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Back to Edit</button>
        <button type="button" class="btn btn-primary" onclick="confirmSetup()">Confirm</button>
      </div>
    </div>
  </div>
</div>



@section Scripts {
<script>
function toggleMatchOptions(){
    let format = document.getElementById("matchFormat").value;
    document.getElementById("poolOptions").style.display = format === "Pool Play" ? "block" : "none";
    document.getElementById("elimOptions").style.display = format === "Elimination" ? "block" : "none";
    document.getElementById("rrOptions").style.display = format === "Round Robin" ? "block" : "none";
}

function reviewSetup() {
    let format = document.getElementById("matchFormat").value;
    let summary = "";

    if (format === "Pool Play") {
        let poolsField = document.getElementById("numPools");
        let winnersField = document.getElementById("winnersPerPool");

        let pools = poolsField ? poolsField.value || 2 : 2;
        let winners = winnersField ? winnersField.value || 1 : 1;

        summary = `${pools} Pools, ${winners} Winners per Pool. 
                   Approx. 8 Teams, 28 Matches, 1 Round, 7 Matches per Team.`;
    } 
    else if (format === "Elimination") {
        summary = `Single Elimination Format. 
                   Approx. 8 Teams, 7 Matches, Includes 3rd Place Match.`;
    } 
    else if (format === "Round Robin") {
        summary = `Round Robin Format. 
                   8 Teams, Each plays 7 Matches. Total ~28 Matches.`;
    }

    document.getElementById("reviewSummary").innerText = summary;
    new bootstrap.Modal(document.getElementById('reviewModal')).show();
}

function confirmSetup() {
    alert("Setup confirmed! Competition ready to publish.");
    window.location.href = '@Url.Action("Index","Community")';
}
</script>
}