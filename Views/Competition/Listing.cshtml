@model IEnumerable<Schedule>
@using FYP_QS_CODE.Models
@{
    ViewData["Title"] = "Active Competitions";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>@ViewData["Title"]</h2>
        @* Maybe add a link back to Community or a Create button? *@
        <a asp-action="Index" asp-controller="Community" class="btn btn-outline-secondary">Back to Community Hub</a>
    </div>

    @if (!Model.Any())
    {
        <div class="alert alert-info" role="alert">
            There are no active competitions scheduled right now.
        </div>
    }
    else
    {
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            @foreach (var comp in Model) @* Model is already filtered by the controller *@
            {
                <div class="col">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">@comp.GameName</h5>

                             @* Display Status Badge *@
                             <span class="badge bg-success align-self-start mb-2">@comp.Status?.ToString()</span>

                            <p class="card-text mb-1 small"><i class="bi bi-geo-alt-fill me-1"></i> @comp.Location</p>
                            <p class="card-text mb-1 small">
                                <i class="bi bi-calendar-event me-1"></i>
                                @if (comp.StartTime.HasValue)
                                {
                                    <span>@comp.StartTime.Value.ToString("ddd, MMM d")</span>
                                    <small class="text-muted"> (@comp.StartTime.Value.ToString("t") - @comp.EndTime?.ToString("t"))</small>
                                }
                            </p>
                             <p class="card-text mb-1 small">
                                <i class="bi bi-calendar-check-fill me-1 text-danger"></i> Reg Close: @comp.RegClose?.ToString("MMM d, t")
                            </p>
                            <p class="card-text small"><i class="bi bi-trophy-fill me-1"></i> @comp.NumTeam Teams</p>

                            @* Optional: Display Format *@
                             @if(comp.Competition != null)
                             {
                                <p class="card-text small"><i class="bi bi-diagram-3-fill me-1"></i> Format: @comp.Competition.Format.ToString()</p>
                             }


                            <div class="mt-auto pt-2">
                                <a asp-controller="Competition" asp-action="CompDetails" asp-route-id="@comp.ScheduleId" class="btn btn-sm btn-outline-primary w-100">View Competition</a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>